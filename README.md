# Excel版本使用说明

## 功能说明

本系统提供了Excel版本的财务测算表，可以在本地Excel中直接进行财务测算，无需打开网页。

## 安装依赖

### Windows系统

双击运行 `install_dependencies.bat`，或手动执行：

```bash
pip install openpyxl
```

### Linux/Mac系统

```bash
pip3 install openpyxl
```

## 生成Excel文件

### 方法一：手动生成

运行以下命令：

```bash
python generate_excel.py
```

Excel文件将保存在当前目录，文件名格式：`德国独立储能电站财务测算表_YYYYMMDD_HHMMSS.xlsx`

### 方法二：自动同步

运行同步脚本，当检测到网页版文件变化时自动更新Excel：

```bash
python sync_excel.py
```

## Excel工作表说明

Excel文件包含以下工作表：

1. **边界设定** - 输入所有基础参数（蓝色背景）
2. **设备配置** - 输入设备价格和数量（蓝色背景）
3. **CAPEX明细** - 自动计算投资明细（黄色背景）
4. **现货价格** - 输入各年现货价格（蓝色背景）
5. **OPEX设定** - 自动计算年度运营成本（黄色背景）
6. **收入预测** - 自动计算年度收入（黄色背景）
7. **折旧计算** - 自动计算折旧摊销（黄色背景）
8. **贷款计算** - 自动计算贷款还款计划（黄色背景）
9. **利润表** - 自动计算利润表（黄色背景）
10. **现金流量表** - 自动计算现金流（黄色背景）
11. **资产负债表** - 自动计算资产负债表（黄色背景）
12. **财务指标** - 自动计算财务指标（绿色背景）

## 颜色说明

- **浅蓝色** - 用户输入区域，可直接修改
- **浅黄色** - 公式计算区域，自动计算
- **浅绿色** - 最终结果区域，重要指标
- **深蓝色** - 表头区域
- **浅灰色** - 小计行

## 使用方法

1. 打开生成的Excel文件
2. 在"边界设定"工作表中修改基础参数（蓝色单元格）
3. 在"设备配置"工作表中修改设备价格（蓝色单元格）
4. 在"现货价格"工作表中修改各年现货价格（蓝色单元格）
5. 所有计算结果（黄色和绿色单元格）将自动更新

## 注意事项

1. **不要修改黄色和绿色单元格** - 这些是公式计算区域，修改可能导致计算错误
2. **参数单位** - 注意参数的单位，如MW、MWh、EUR等
3. **百分比输入** - 百分比参数直接输入数字，如25表示25%，不需要输入%
4. **公式引用** - Excel使用工作表间的公式引用，确保所有工作表都存在
5. **版本同步** - 每次网页版功能更新后，请重新运行 `generate_excel.py` 生成最新版本

## 与网页版的区别

- **Excel版本**：适合离线使用，可以保存多个版本，方便对比分析
- **网页版本**：界面更友好，有图表可视化，适合演示和快速计算

两者计算逻辑完全一致，结果应该相同。

## 故障排除

### 问题：提示找不到openpyxl模块

**解决方案**：
```bash
pip install openpyxl
```

### 问题：Excel文件打开后公式显示错误

**解决方案**：
1. 确保所有工作表都存在
2. 检查工作表名称是否正确（区分大小写）
3. 重新生成Excel文件

### 问题：计算结果与网页版不一致

**解决方案**：
1. 检查输入参数是否完全一致
2. 确保使用的是最新版本的Excel文件
3. 重新运行 `generate_excel.py` 生成最新版本

## 技术支持

如有问题，请联系：lingxiao385@gmail.com
